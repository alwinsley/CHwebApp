{"ast":null,"code":"import _objectSpread from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/src/app/main/pages/calendar/EventDialog.js\";\nimport React, { Component } from 'react';\nimport { TextField, Button, Dialog, DialogActions, DialogContent, Icon, IconButton, Typography, Toolbar, AppBar, FormControlLabel, Switch, Select, FormControl, Input, Chip, MenuItem } from '@material-ui/core';\nimport FuseUtils from '@fuse/FuseUtils';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport _ from '@lodash';\nimport moment from 'moment';\nimport * as Actions from './store/actions';\nimport { wrap } from 'module';\nimport { FuseChipSelect } from '@fuse';\nimport * as jwt_decode from \"jwt-decode\";\nimport history from 'history.js';\nvar song = [];\nvar limit = 10; //----------get user data----------\n\nvar token = localStorage.getItem('token');\nvar decoded = []; //----------Api config ---------\n\nvar api_host = \"http://localhost:8080\";\nvar headers = new Headers();\nheaders.append('Access-Control-Allow-Origin', 'http://localhost:8080');\nheaders.append('Access-Control-Allow-Credentials', 'true');\nheaders.append('Content-Type', 'application/json');\nheaders.append('authorization', 'Bearer ' + token);\nvar defaultEventState = {\n  id: FuseUtils.generateGUID(),\n  title: '',\n  allDay: true,\n  start: new Date(),\n  end: new Date(),\n  desc: '',\n  song_name: [],\n  song_id: [],\n  songs: [],\n  tags: []\n};\nvar ITEM_HEIGHT = 48;\nvar ITEM_PADDING_TOP = 8;\nvar MenuProps = {\n  PaperProps: {\n    style: {\n      maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\n      width: 250\n    }\n  }\n};\n\nfunction getStyles(name, that) {\n  return {\n    fontWeight: that.state.song_name.indexOf(name) === -1 ? 400 : 600\n  };\n}\n\nvar EventDialog =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EventDialog, _Component);\n\n  function EventDialog() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EventDialog);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EventDialog)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = _objectSpread({}, defaultEventState);\n\n    _this.handleChange = function (event) {\n      // console.log(event.target);\n      _this.setState(_.set(_objectSpread({}, _this.state), event.target.name, event.target.type === 'checkbox' ? event.target.checked : event.target.value, {\n        song_id: event.target.value\n      }));\n    };\n\n    _this.handleSongChange = function (event) {\n      _this.setState({\n        song_id: event.target.value\n      });\n    };\n\n    _this.handleChipChange = function (value) {\n      var song_id = [];\n      console.log(value);\n\n      _this.setState({\n        tags: value\n      });\n\n      value.forEach(function (tag) {\n        song_id.push(tag.value);\n      });\n\n      _this.setState({\n        song_id: song_id\n      });\n    };\n\n    _this.closeComposeDialog = function () {\n      _this.props.eventDialog.type === 'edit' ? _this.props.closeEditEventDialog() : _this.props.closeNewEventDialog();\n    };\n\n    return _this;\n  }\n\n  _createClass(EventDialog, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      var _this2 = this;\n\n      /**\n       * After Dialog Open\n       */\n      if (!prevProps.eventDialog.props.open && this.props.eventDialog.props.open) {\n        /**\n         * Dialog type: 'edit'\n         * Update State\n         */\n        if (this.props.eventDialog.type === 'edit' && this.props.eventDialog.data && !_.isEqual(this.props.eventDialog.data, prevState)) {\n          this.setState(_objectSpread({}, this.props.eventDialog.data));\n        }\n        /**\n         * Dialog type: 'new'\n         * Update State\n         */\n\n\n        if (this.props.eventDialog.type === 'new') {\n          this.setState(_objectSpread({}, defaultEventState, this.props.eventDialog.data));\n        }\n\n        if (token != null && token != \"\") {\n          decoded = jwt_decode(token);\n          fetch(api_host + '/user/getById/' + decoded.user.id, {\n            method: 'GET',\n            headers: headers\n          }).then(function (response) {\n            response.json().then(function (data) {\n              console.log(data);\n\n              if (data.length != 0) {\n                limit = \"unlimit\";\n              } else {\n                limit = 10;\n              }\n\n              fetch(api_host + '/song/' + limit, {\n                method: 'GET',\n                headers: headers\n              }).then(function (response) {\n                response.json().then(function (data) {\n                  console.log(data);\n\n                  _this2.setState({\n                    songs: data\n                  }); // console.log(\"state:\", this.state.songs)\n\n                });\n              });\n            });\n          });\n        } else {\n          history.push('/');\n        }\n      }\n    }\n  }, {\n    key: \"canBeSubmitted\",\n    value: function canBeSubmitted() {\n      var title = this.state.title;\n      return title.length > 0;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props = this.props,\n          eventDialog = _this$props.eventDialog,\n          addEvent = _this$props.addEvent,\n          updateEvent = _this$props.updateEvent,\n          removeEvent = _this$props.removeEvent,\n          classes = _this$props.classes;\n      var start = moment(this.state.start).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n      var end = moment(this.state.end).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n      var suggestions = this.state.songs.map(function (item) {\n        return {\n          value: item.id,\n          label: item.name\n        };\n      });\n      console.log(this.state);\n      return React.createElement(Dialog, Object.assign({}, eventDialog.props, {\n        onClose: this.closeComposeDialog,\n        fullWidth: true,\n        maxWidth: \"xs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }), React.createElement(AppBar, {\n        position: \"static\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        className: \"flex w-full\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        variant: \"subtitle1\",\n        color: \"inherit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, eventDialog.type === 'new' ? 'New Event' : 'Edit Event'))), React.createElement(DialogContent, {\n        classes: {\n          root: \"p-16 pb-0 sm:p-24 sm:pb-0\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        id: \"title\",\n        label: \"Title\",\n        className: \"mt-8 mb-16\",\n        InputLabelProps: {\n          shrink: true\n        },\n        inputProps: {\n          max: end\n        },\n        name: \"title\",\n        value: this.state.title,\n        onChange: this.handleChange,\n        variant: \"outlined\",\n        autoFocus: true,\n        required: true,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }), React.createElement(FormControlLabel, {\n        className: \"mt-8 mb-16\",\n        label: \"All Day\",\n        control: React.createElement(Switch, {\n          checked: this.state.allDay,\n          id: \"allDay\",\n          name: \"allDay\",\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        id: \"start\",\n        name: \"start\",\n        label: \"Start\",\n        type: \"datetime-local\",\n        className: \"mt-8 mb-16\",\n        InputLabelProps: {\n          shrink: true\n        },\n        inputProps: {\n          max: end\n        },\n        value: start,\n        onChange: this.handleChange,\n        variant: \"outlined\",\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        id: \"end\",\n        name: \"end\",\n        label: \"End\",\n        type: \"datetime-local\",\n        className: \"mt-8 mb-16\",\n        InputLabelProps: {\n          shrink: true\n        },\n        inputProps: {\n          min: start\n        },\n        value: end,\n        onChange: this.handleChange,\n        variant: \"outlined\",\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        className: \"mt-8 mb-16\",\n        id: \"desc\",\n        label: \"Description\",\n        type: \"text\",\n        name: \"desc\",\n        value: this.state.desc,\n        onChange: this.handleChange,\n        multiline: true,\n        rows: 5,\n        variant: \"outlined\",\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 262\n        },\n        __self: this\n      }), React.createElement(FuseChipSelect, {\n        className: \"w-full my-16\",\n        value: this.state.tags,\n        onChange: this.handleChipChange,\n        placeholder: \"Select multiple tags\",\n        textFieldProps: {\n          label: 'Tags',\n          InputLabelProps: {\n            shrink: true\n          },\n          variant: 'standard'\n        },\n        options: suggestions,\n        isMulti: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274\n        },\n        __self: this\n      })), eventDialog.type === 'new' ? React.createElement(DialogActions, {\n        className: \"justify-between pl-8 sm:pl-16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: function onClick() {\n          addEvent(_this3.state);\n\n          _this3.closeComposeDialog();\n        },\n        disabled: !this.canBeSubmitted(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }, \"Add\")) : React.createElement(DialogActions, {\n        className: \"justify-between pl-8 sm:pl-16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: function onClick() {\n          updateEvent(_this3.state);\n\n          _this3.closeComposeDialog();\n        },\n        disabled: !this.canBeSubmitted(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, \" Save\"), React.createElement(IconButton, {\n        onClick: function onClick() {\n          removeEvent(_this3.state.id);\n\n          _this3.closeComposeDialog();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323\n        },\n        __self: this\n      }, \"delete\"))));\n    }\n  }]);\n\n  return EventDialog;\n}(Component);\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    closeEditEventDialog: Actions.closeEditEventDialog,\n    closeNewEventDialog: Actions.closeNewEventDialog,\n    addEvent: Actions.addEvent,\n    updateEvent: Actions.updateEvent,\n    removeEvent: Actions.removeEvent\n  }, dispatch);\n}\n\nfunction mapStateToProps(_ref) {\n  var calendarApp = _ref.calendarApp;\n  return {\n    eventDialog: calendarApp.events.eventDialog\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EventDialog);","map":{"version":3,"sources":["/Users/ALJohnny/Desktop/Git/ReactCHLayout/src/app/main/pages/calendar/EventDialog.js"],"names":["React","Component","TextField","Button","Dialog","DialogActions","DialogContent","Icon","IconButton","Typography","Toolbar","AppBar","FormControlLabel","Switch","Select","FormControl","Input","Chip","MenuItem","FuseUtils","bindActionCreators","connect","_","moment","Actions","wrap","FuseChipSelect","jwt_decode","history","song","limit","token","localStorage","getItem","decoded","api_host","headers","Headers","append","defaultEventState","id","generateGUID","title","allDay","start","Date","end","desc","song_name","song_id","songs","tags","ITEM_HEIGHT","ITEM_PADDING_TOP","MenuProps","PaperProps","style","maxHeight","width","getStyles","name","that","fontWeight","state","indexOf","EventDialog","handleChange","event","setState","set","target","type","checked","value","handleSongChange","handleChipChange","console","log","forEach","tag","push","closeComposeDialog","props","eventDialog","closeEditEventDialog","closeNewEventDialog","prevProps","prevState","snapshot","open","data","isEqual","fetch","user","method","then","response","json","length","addEvent","updateEvent","removeEvent","classes","format","HTML5_FMT","DATETIME_LOCAL_SECONDS","suggestions","map","item","label","root","shrink","max","min","InputLabelProps","variant","canBeSubmitted","mapDispatchToProps","dispatch","mapStateToProps","calendarApp","events"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {TextField, Button, Dialog, DialogActions, DialogContent, \n    Icon, IconButton, Typography, Toolbar, AppBar, FormControlLabel, Switch, \n    Select, FormControl, Input, Chip, MenuItem} from '@material-ui/core';\nimport FuseUtils from '@fuse/FuseUtils';\nimport {bindActionCreators} from 'redux';\nimport {connect} from 'react-redux';\nimport _ from '@lodash';\nimport moment from 'moment';\nimport * as Actions from './store/actions';\nimport { wrap } from 'module';\n\nimport {FuseChipSelect} from '@fuse';\n\n\nimport * as jwt_decode from \"jwt-decode\";\nimport history from 'history.js';\n\nlet song = [];\nlet limit = 10;\n\n\n//----------get user data----------\nvar token = localStorage.getItem('token');\nvar decoded = [];\n\n//----------Api config ---------\nconst api_host = \"http://localhost:8080\";\n\nlet headers = new Headers();\n\nheaders.append('Access-Control-Allow-Origin', 'http://localhost:8080');\nheaders.append('Access-Control-Allow-Credentials', 'true');\nheaders.append('Content-Type', 'application/json');\nheaders.append('authorization', 'Bearer ' + token);\n\nconst defaultEventState = {\n    id    : FuseUtils.generateGUID(),\n    title : '',\n    allDay: true,\n    start : new Date(),\n    end   : new Date(),\n    desc  : '',\n    song_name  : [],\n    song_id: [],\n    songs: [],\n    tags: [],\n};\n\n\nconst ITEM_HEIGHT = 48;\nconst ITEM_PADDING_TOP = 8;\n\nconst MenuProps = {\n    PaperProps: {\n      style: {\n        maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\n        width: 250,\n      },\n    },\n  };\n\nfunction getStyles(name, that) {\n    return {\n      fontWeight:\n        that.state.song_name.indexOf(name) === -1\n          ? 400\n          : 600,\n    };\n}\n\nclass EventDialog extends Component {\n\n    state = {...defaultEventState};\n\n\n    componentDidUpdate(prevProps, prevState, snapshot)\n    {\n        /**\n         * After Dialog Open\n         */\n        if ( !prevProps.eventDialog.props.open && this.props.eventDialog.props.open )\n        {\n            /**\n             * Dialog type: 'edit'\n             * Update State\n             */\n            if ( this.props.eventDialog.type === 'edit' &&\n                this.props.eventDialog.data &&\n                !_.isEqual(this.props.eventDialog.data, prevState) )\n            {\n                this.setState({...this.props.eventDialog.data});\n            }\n\n            /**\n             * Dialog type: 'new'\n             * Update State\n             */\n            if ( this.props.eventDialog.type === 'new' )\n            {\n                this.setState({...defaultEventState, ...this.props.eventDialog.data});\n            }\n\n            if(token != null && token != \"\"){\n                decoded = jwt_decode(token);\n          \n                fetch(api_host + '/user/getById/' + decoded.user.id, {\n                  method: 'GET',\n                  headers: headers,\n                })\n                .then(response => {\n                  response.json().then(data => {\n                    console.log(data); \n                    if(data.length != 0){\n                      limit = \"unlimit\";\n                    }else{\n                      limit = 10;\n                    }\n                \n                    fetch(api_host + '/song/' + limit, {\n                      method: 'GET',\n                      headers: headers,\n                    })\n                    .then(response => {\n                      response.json().then(data => {\n                        console.log(data);\n                        this.setState({ songs: data });\n                        // console.log(\"state:\", this.state.songs)\n                      });\n                    });\n                  });\n                });\n            }else{\n            history.push('/');\n            }   \n        }\n    }\n\n    handleChange = (event) => {\n        // console.log(event.target);\n        this.setState(_.set({...this.state}, event.target.name, event.target.type === 'checkbox' ? event.target.checked : event.target.value, { song_id: event.target.value }));\n      \n    };\n\n    handleSongChange = (event) => {\n        this.setState({ song_id: event.target.value });\n    };\n\n    handleChipChange = (value) => {\n        var song_id = [];\n        console.log(value);\n        this.setState({tags: value});\n        value.forEach(tag => {\n            song_id.push(tag.value);   \n        });\n        this.setState({song_id: song_id});\n    };\n    \n    closeComposeDialog = () => {\n        this.props.eventDialog.type === 'edit' ? this.props.closeEditEventDialog() : this.props.closeNewEventDialog();\n    };\n\n    canBeSubmitted()\n    {\n        const {title} = this.state;\n        return (\n            title.length > 0\n        );\n    }\n\n    render()\n    {\n        const {eventDialog, addEvent, updateEvent, removeEvent, classes} = this.props;\n        const start = moment(this.state.start).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n        const end = moment(this.state.end).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n\n        const suggestions = this.state.songs.map(item => ({\n            value: item.id,\n            label: item.name\n        }));\n\n       \n        console.log(this.state);\n        return (\n            <Dialog {...eventDialog.props} onClose={this.closeComposeDialog} fullWidth maxWidth=\"xs\">\n\n                <AppBar position=\"static\">\n                    <Toolbar className=\"flex w-full\">\n                        <Typography variant=\"subtitle1\" color=\"inherit\">\n                            {eventDialog.type === 'new' ? 'New Event' : 'Edit Event'}\n                        </Typography>\n                    </Toolbar>\n                </AppBar>\n\n                <DialogContent classes={{root: \"p-16 pb-0 sm:p-24 sm:pb-0\"}}>\n\n                    <TextField\n                        id=\"title\"\n                        label=\"Title\"\n                        className=\"mt-8 mb-16\"\n                        InputLabelProps={{\n                            shrink: true\n                        }}\n                        inputProps={{\n                            max: end\n                        }}\n                        name=\"title\"\n                        value={this.state.title}\n                        onChange={this.handleChange}\n                        variant=\"outlined\"\n                        autoFocus\n                        required\n                        fullWidth\n                    />\n\n                    <FormControlLabel\n                        className=\"mt-8 mb-16\"\n                        label=\"All Day\"\n                        control={\n                            <Switch\n                                checked={this.state.allDay}\n                                id=\"allDay\" name=\"allDay\" onChange={this.handleChange}\n                            />\n                        }/>\n\n                    <TextField\n                        id=\"start\"\n                        name=\"start\"\n                        label=\"Start\"\n                        type=\"datetime-local\"\n                        className=\"mt-8 mb-16\"\n                        InputLabelProps={{\n                            shrink: true\n                        }}\n                        inputProps={{\n                            max: end\n                        }}\n                        value={start}\n                        onChange={this.handleChange}\n                        variant=\"outlined\"\n                        fullWidth\n                    />\n\n                    <TextField\n                        id=\"end\"\n                        name=\"end\"\n                        label=\"End\"\n                        type=\"datetime-local\"\n                        className=\"mt-8 mb-16\"\n                        InputLabelProps={{\n                            shrink: true\n                        }}\n                        inputProps={{\n                            min: start\n                        }}\n                        value={end}\n                        onChange={this.handleChange}\n                        variant=\"outlined\"\n                        fullWidth\n                    />\n\n                    <TextField\n                        className=\"mt-8 mb-16\"\n                        id=\"desc\" label=\"Description\"\n                        type=\"text\"\n                        name=\"desc\"\n                        value={this.state.desc}\n                        onChange={this.handleChange}\n                        multiline rows={5}\n                        variant=\"outlined\"\n                        fullWidth\n                    />\n\n                    <FuseChipSelect\n                        className=\"w-full my-16\"\n                        value={this.state.tags}\n                        onChange={this.handleChipChange}\n                        placeholder=\"Select multiple tags\"\n                        textFieldProps={{\n                            label          : 'Tags',\n                            InputLabelProps: {\n                                shrink: true\n                            },\n                            variant        : 'standard'\n                        }}\n                        options={suggestions}\n                        isMulti\n                    />\n                </DialogContent>\n\n                {eventDialog.type === 'new' ? (\n                    <DialogActions className=\"justify-between pl-8 sm:pl-16\">\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            onClick={() => {\n                                addEvent(this.state);\n                                this.closeComposeDialog();\n                            }}\n                            disabled={!this.canBeSubmitted()}\n                        >\n                            Add\n                        </Button>\n                    </DialogActions>\n                ) : (\n                    <DialogActions className=\"justify-between pl-8 sm:pl-16\">\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            onClick={() => {\n                                updateEvent(this.state);\n                                this.closeComposeDialog();\n                            }}\n                            disabled={!this.canBeSubmitted()}\n                        > Save\n                        </Button>\n                        <IconButton\n                            onClick={() => {\n                                removeEvent(this.state.id);\n                                this.closeComposeDialog();\n                            }}\n                        >\n                            <Icon>delete</Icon>\n                        </IconButton>\n                    </DialogActions>\n                )}\n            </Dialog>\n        );\n    }\n}\n\n\nfunction mapDispatchToProps(dispatch)\n{\n    return bindActionCreators({\n        closeEditEventDialog: Actions.closeEditEventDialog,\n        closeNewEventDialog : Actions.closeNewEventDialog,\n        addEvent            : Actions.addEvent,\n        updateEvent         : Actions.updateEvent,\n        removeEvent         : Actions.removeEvent\n    }, dispatch);\n}\n\nfunction mapStateToProps({calendarApp})\n{\n    return {\n        eventDialog: calendarApp.events.eventDialog\n    }\n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EventDialog);\n"]},"metadata":{},"sourceType":"module"}