{"ast":null,"code":"import _objectSpread from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/ALJohnny/Desktop/Git/ReactCHLayout/src/app/main/pages/calendar/EventDialog.js\";\nimport React, { Component } from 'react';\nimport { TextField, Button, Dialog, DialogActions, DialogContent, Icon, IconButton, Typography, Toolbar, AppBar, FormControlLabel, Switch, Select, FormControl, Input, Chip, MenuItem } from '@material-ui/core';\nimport FuseUtils from '@fuse/FuseUtils';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport _ from '@lodash';\nimport moment from 'moment';\nimport * as Actions from './store/actions';\nimport { wrap } from 'module';\nimport { FuseChipSelect } from '@fuse';\nimport * as jwt_decode from \"jwt-decode\";\nimport history from 'history.js';\nvar song = [];\nvar limit = 10; //----------get user data----------\n\nvar token = localStorage.getItem('token');\nvar decoded = []; //----------Api config ---------\n\nvar api_host = \"http://localhost:8080\";\nvar headers = new Headers();\nheaders.append('Access-Control-Allow-Origin', 'http://localhost:8080');\nheaders.append('Access-Control-Allow-Credentials', 'true');\nheaders.append('Content-Type', 'application/json');\nheaders.append('authorization', 'Bearer ' + token);\nvar defaultEventState = {\n  id: FuseUtils.generateGUID(),\n  title: '',\n  allDay: true,\n  start: new Date(),\n  end: new Date(),\n  desc: '',\n  song_name: [],\n  song_id: [],\n  songs: [],\n  tags: []\n};\nvar ITEM_HEIGHT = 48;\nvar ITEM_PADDING_TOP = 8;\nvar MenuProps = {\n  PaperProps: {\n    style: {\n      maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\n      width: 250\n    }\n  }\n};\n\nfunction getStyles(name, that) {\n  return {\n    fontWeight: that.state.song_name.indexOf(name) === -1 ? 400 : 600\n  };\n}\n\nvar EventDialog =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EventDialog, _Component);\n\n  function EventDialog() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EventDialog);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EventDialog)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = _objectSpread({}, defaultEventState);\n\n    _this.handleChange = function (event) {\n      // console.log(event.target);\n      _this.setState(_.set(_objectSpread({}, _this.state), event.target.name, event.target.type === 'checkbox' ? event.target.checked : event.target.value, {\n        song_id: event.target.value\n      }));\n    };\n\n    _this.handleSongChange = function (event) {\n      _this.setState({\n        song_id: event.target.value\n      });\n    };\n\n    _this.handleChipChange = function (value) {\n      var song_id = [];\n      console.log(value);\n\n      _this.setState({\n        tags: value\n      });\n\n      value.forEach(function (tag) {\n        song_id.push(tag.value);\n      });\n\n      _this.setState({\n        song_id: song_id\n      });\n    };\n\n    _this.closeComposeDialog = function () {\n      _this.props.eventDialog.type === 'edit' ? _this.props.closeEditEventDialog() : _this.props.closeNewEventDialog();\n    };\n\n    return _this;\n  }\n\n  _createClass(EventDialog, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      var _this2 = this;\n\n      /**\n       * After Dialog Open\n       */\n      if (!prevProps.eventDialog.props.open && this.props.eventDialog.props.open) {\n        /**\n         * Dialog type: 'edit'\n         * Update State\n         */\n        if (this.props.eventDialog.type === 'edit' && this.props.eventDialog.data && !_.isEqual(this.props.eventDialog.data, prevState)) {\n          this.setState(_objectSpread({}, this.props.eventDialog.data));\n        }\n        /**\n         * Dialog type: 'new'\n         * Update State\n         */\n\n\n        if (this.props.eventDialog.type === 'new') {\n          this.setState(_objectSpread({}, defaultEventState, this.props.eventDialog.data));\n        }\n\n        if (token != null && token != \"\") {\n          decoded = jwt_decode(token);\n          fetch(api_host + '/user/getById/' + decoded.user.id, {\n            method: 'GET',\n            headers: headers\n          }).then(function (response) {\n            response.json().then(function (data) {\n              console.log(data);\n\n              if (data.length != 0) {\n                limit = \"unlimit\";\n              } else {\n                limit = 10;\n              }\n\n              fetch(api_host + '/song/' + limit, {\n                method: 'GET',\n                headers: headers\n              }).then(function (response) {\n                response.json().then(function (data) {\n                  console.log(data);\n\n                  _this2.setState({\n                    songs: data\n                  }); // console.log(\"state:\", this.state.songs)\n\n                });\n              });\n            });\n          });\n        } else {\n          history.push('/login');\n        }\n      }\n    }\n  }, {\n    key: \"canBeSubmitted\",\n    value: function canBeSubmitted() {\n      var title = this.state.title;\n      return title.length > 0;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props = this.props,\n          eventDialog = _this$props.eventDialog,\n          addEvent = _this$props.addEvent,\n          updateEvent = _this$props.updateEvent,\n          removeEvent = _this$props.removeEvent,\n          classes = _this$props.classes;\n      var start = moment(this.state.start).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n      var end = moment(this.state.end).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n      var suggestions = this.state.songs.map(function (item) {\n        return {\n          value: item.id,\n          label: item.name\n        };\n      });\n      console.log(this.state);\n      return React.createElement(Dialog, Object.assign({}, eventDialog.props, {\n        onClose: this.closeComposeDialog,\n        fullWidth: true,\n        maxWidth: \"xs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }), React.createElement(AppBar, {\n        position: \"static\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        className: \"flex w-full\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        variant: \"subtitle1\",\n        color: \"inherit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, eventDialog.type === 'new' ? 'New Event' : 'Edit Event'))), React.createElement(DialogContent, {\n        classes: {\n          root: \"p-16 pb-0 sm:p-24 sm:pb-0\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        id: \"title\",\n        label: \"Title\",\n        className: \"mt-8 mb-16\",\n        InputLabelProps: {\n          shrink: true\n        },\n        inputProps: {\n          max: end\n        },\n        name: \"title\",\n        value: this.state.title,\n        onChange: this.handleChange,\n        variant: \"outlined\",\n        autoFocus: true,\n        required: true,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }), React.createElement(FormControlLabel, {\n        className: \"mt-8 mb-16\",\n        label: \"All Day\",\n        control: React.createElement(Switch, {\n          checked: this.state.allDay,\n          id: \"allDay\",\n          name: \"allDay\",\n          onChange: this.handleChange,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        id: \"start\",\n        name: \"start\",\n        label: \"Start\",\n        type: \"datetime-local\",\n        className: \"mt-8 mb-16\",\n        InputLabelProps: {\n          shrink: true\n        },\n        inputProps: {\n          max: end\n        },\n        value: start,\n        onChange: this.handleChange,\n        variant: \"outlined\",\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        id: \"end\",\n        name: \"end\",\n        label: \"End\",\n        type: \"datetime-local\",\n        className: \"mt-8 mb-16\",\n        InputLabelProps: {\n          shrink: true\n        },\n        inputProps: {\n          min: start\n        },\n        value: end,\n        onChange: this.handleChange,\n        variant: \"outlined\",\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        className: \"mt-8 mb-16\",\n        id: \"desc\",\n        label: \"Description\",\n        type: \"text\",\n        name: \"desc\",\n        value: this.state.desc,\n        onChange: this.handleChange,\n        multiline: true,\n        rows: 5,\n        variant: \"outlined\",\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }), React.createElement(FuseChipSelect, {\n        className: \"w-full my-16\",\n        value: this.state.tags,\n        onChange: this.handleChipChange,\n        placeholder: \"Select multiple tags\",\n        textFieldProps: {\n          label: 'Tags',\n          InputLabelProps: {\n            shrink: true\n          },\n          variant: 'standard'\n        },\n        options: suggestions,\n        isMulti: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270\n        },\n        __self: this\n      })), eventDialog.type === 'new' ? React.createElement(DialogActions, {\n        className: \"justify-between pl-8 sm:pl-16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: function onClick() {\n          addEvent(_this3.state);\n\n          _this3.closeComposeDialog();\n        },\n        disabled: !this.canBeSubmitted(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 289\n        },\n        __self: this\n      }, \"Add\")) : React.createElement(DialogActions, {\n        className: \"justify-between pl-8 sm:pl-16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: function onClick() {\n          updateEvent(_this3.state);\n\n          _this3.closeComposeDialog();\n        },\n        disabled: !this.canBeSubmitted(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303\n        },\n        __self: this\n      }, \" Save\"), React.createElement(IconButton, {\n        onClick: function onClick() {\n          removeEvent(_this3.state.id);\n\n          _this3.closeComposeDialog();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, \"delete\"))));\n    }\n  }]);\n\n  return EventDialog;\n}(Component);\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators({\n    closeEditEventDialog: Actions.closeEditEventDialog,\n    closeNewEventDialog: Actions.closeNewEventDialog,\n    addEvent: Actions.addEvent,\n    updateEvent: Actions.updateEvent,\n    removeEvent: Actions.removeEvent\n  }, dispatch);\n}\n\nfunction mapStateToProps(_ref) {\n  var calendarApp = _ref.calendarApp;\n  return {\n    eventDialog: calendarApp.events.eventDialog\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EventDialog);","map":{"version":3,"sources":["/Users/ALJohnny/Desktop/Git/ReactCHLayout/src/app/main/pages/calendar/EventDialog.js"],"names":["React","Component","TextField","Button","Dialog","DialogActions","DialogContent","Icon","IconButton","Typography","Toolbar","AppBar","FormControlLabel","Switch","Select","FormControl","Input","Chip","MenuItem","FuseUtils","bindActionCreators","connect","_","moment","Actions","wrap","FuseChipSelect","jwt_decode","history","song","limit","token","localStorage","getItem","decoded","api_host","headers","Headers","append","defaultEventState","id","generateGUID","title","allDay","start","Date","end","desc","song_name","song_id","songs","tags","ITEM_HEIGHT","ITEM_PADDING_TOP","MenuProps","PaperProps","style","maxHeight","width","getStyles","name","that","fontWeight","state","indexOf","EventDialog","handleChange","event","setState","set","target","type","checked","value","handleSongChange","handleChipChange","console","log","forEach","tag","push","closeComposeDialog","props","eventDialog","closeEditEventDialog","closeNewEventDialog","prevProps","prevState","snapshot","open","data","isEqual","fetch","user","method","then","response","json","length","addEvent","updateEvent","removeEvent","classes","format","HTML5_FMT","DATETIME_LOCAL_SECONDS","suggestions","map","item","label","root","shrink","max","min","InputLabelProps","variant","canBeSubmitted","mapDispatchToProps","dispatch","mapStateToProps","calendarApp","events"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n    TextField, Button, Dialog, DialogActions, DialogContent,\n    Icon, IconButton, Typography, Toolbar, AppBar, FormControlLabel, Switch,\n    Select, FormControl, Input, Chip, MenuItem\n} from '@material-ui/core';\nimport FuseUtils from '@fuse/FuseUtils';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport _ from '@lodash';\nimport moment from 'moment';\nimport * as Actions from './store/actions';\nimport { wrap } from 'module';\n\nimport { FuseChipSelect } from '@fuse';\n\n\nimport * as jwt_decode from \"jwt-decode\";\nimport history from 'history.js';\n\nlet song = [];\nlet limit = 10;\n\n\n//----------get user data----------\nvar token = localStorage.getItem('token');\nvar decoded = [];\n\n//----------Api config ---------\nconst api_host = \"http://localhost:8080\";\n\nlet headers = new Headers();\n\nheaders.append('Access-Control-Allow-Origin', 'http://localhost:8080');\nheaders.append('Access-Control-Allow-Credentials', 'true');\nheaders.append('Content-Type', 'application/json');\nheaders.append('authorization', 'Bearer ' + token);\n\nconst defaultEventState = {\n    id: FuseUtils.generateGUID(),\n    title: '',\n    allDay: true,\n    start: new Date(),\n    end: new Date(),\n    desc: '',\n    song_name: [],\n    song_id: [],\n    songs: [],\n    tags: [],\n};\n\n\nconst ITEM_HEIGHT = 48;\nconst ITEM_PADDING_TOP = 8;\n\nconst MenuProps = {\n    PaperProps: {\n        style: {\n            maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\n            width: 250,\n        },\n    },\n};\n\nfunction getStyles(name, that) {\n    return {\n        fontWeight:\n            that.state.song_name.indexOf(name) === -1\n                ? 400\n                : 600,\n    };\n}\n\nclass EventDialog extends Component {\n\n    state = { ...defaultEventState };\n\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        /**\n         * After Dialog Open\n         */\n        if (!prevProps.eventDialog.props.open && this.props.eventDialog.props.open) {\n            /**\n             * Dialog type: 'edit'\n             * Update State\n             */\n            if (this.props.eventDialog.type === 'edit' &&\n                this.props.eventDialog.data &&\n                !_.isEqual(this.props.eventDialog.data, prevState)) {\n                this.setState({ ...this.props.eventDialog.data });\n            }\n\n            /**\n             * Dialog type: 'new'\n             * Update State\n             */\n            if (this.props.eventDialog.type === 'new') {\n                this.setState({ ...defaultEventState, ...this.props.eventDialog.data });\n            }\n\n            if (token != null && token != \"\") {\n                decoded = jwt_decode(token);\n\n                fetch(api_host + '/user/getById/' + decoded.user.id, {\n                    method: 'GET',\n                    headers: headers,\n                })\n                    .then(response => {\n                        response.json().then(data => {\n                            console.log(data);\n                            if (data.length != 0) {\n                                limit = \"unlimit\";\n                            } else {\n                                limit = 10;\n                            }\n\n                            fetch(api_host + '/song/' + limit, {\n                                method: 'GET',\n                                headers: headers,\n                            })\n                                .then(response => {\n                                    response.json().then(data => {\n                                        console.log(data);\n                                        this.setState({ songs: data });\n                                        // console.log(\"state:\", this.state.songs)\n                                    });\n                                });\n                        });\n                    });\n            } else {\n                history.push('/login');\n            }\n        }\n    }\n\n    handleChange = (event) => {\n        // console.log(event.target);\n        this.setState(_.set({ ...this.state }, event.target.name, event.target.type === 'checkbox' ? event.target.checked : event.target.value, { song_id: event.target.value }));\n\n    };\n\n    handleSongChange = (event) => {\n        this.setState({ song_id: event.target.value });\n    };\n\n    handleChipChange = (value) => {\n        var song_id = [];\n        console.log(value);\n        this.setState({ tags: value });\n        value.forEach(tag => {\n            song_id.push(tag.value);\n        });\n        this.setState({ song_id: song_id });\n    };\n\n    closeComposeDialog = () => {\n        this.props.eventDialog.type === 'edit' ? this.props.closeEditEventDialog() : this.props.closeNewEventDialog();\n    };\n\n    canBeSubmitted() {\n        const { title } = this.state;\n        return (\n            title.length > 0\n        );\n    }\n\n    render() {\n        const { eventDialog, addEvent, updateEvent, removeEvent, classes } = this.props;\n        const start = moment(this.state.start).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n        const end = moment(this.state.end).format(moment.HTML5_FMT.DATETIME_LOCAL_SECONDS);\n\n        const suggestions = this.state.songs.map(item => ({\n            value: item.id,\n            label: item.name\n        }));\n\n\n        console.log(this.state);\n        return (\n            <Dialog {...eventDialog.props} onClose={this.closeComposeDialog} fullWidth maxWidth=\"xs\">\n\n                <AppBar position=\"static\">\n                    <Toolbar className=\"flex w-full\">\n                        <Typography variant=\"subtitle1\" color=\"inherit\">\n                            {eventDialog.type === 'new' ? 'New Event' : 'Edit Event'}\n                        </Typography>\n                    </Toolbar>\n                </AppBar>\n\n                <DialogContent classes={{ root: \"p-16 pb-0 sm:p-24 sm:pb-0\" }}>\n\n                    <TextField\n                        id=\"title\"\n                        label=\"Title\"\n                        className=\"mt-8 mb-16\"\n                        InputLabelProps={{\n                            shrink: true\n                        }}\n                        inputProps={{\n                            max: end\n                        }}\n                        name=\"title\"\n                        value={this.state.title}\n                        onChange={this.handleChange}\n                        variant=\"outlined\"\n                        autoFocus\n                        required\n                        fullWidth\n                    />\n\n                    <FormControlLabel\n                        className=\"mt-8 mb-16\"\n                        label=\"All Day\"\n                        control={\n                            <Switch\n                                checked={this.state.allDay}\n                                id=\"allDay\" name=\"allDay\" onChange={this.handleChange}\n                            />\n                        } />\n\n                    <TextField\n                        id=\"start\"\n                        name=\"start\"\n                        label=\"Start\"\n                        type=\"datetime-local\"\n                        className=\"mt-8 mb-16\"\n                        InputLabelProps={{\n                            shrink: true\n                        }}\n                        inputProps={{\n                            max: end\n                        }}\n                        value={start}\n                        onChange={this.handleChange}\n                        variant=\"outlined\"\n                        fullWidth\n                    />\n\n                    <TextField\n                        id=\"end\"\n                        name=\"end\"\n                        label=\"End\"\n                        type=\"datetime-local\"\n                        className=\"mt-8 mb-16\"\n                        InputLabelProps={{\n                            shrink: true\n                        }}\n                        inputProps={{\n                            min: start\n                        }}\n                        value={end}\n                        onChange={this.handleChange}\n                        variant=\"outlined\"\n                        fullWidth\n                    />\n\n                    <TextField\n                        className=\"mt-8 mb-16\"\n                        id=\"desc\" label=\"Description\"\n                        type=\"text\"\n                        name=\"desc\"\n                        value={this.state.desc}\n                        onChange={this.handleChange}\n                        multiline rows={5}\n                        variant=\"outlined\"\n                        fullWidth\n                    />\n\n                    <FuseChipSelect\n                        className=\"w-full my-16\"\n                        value={this.state.tags}\n                        onChange={this.handleChipChange}\n                        placeholder=\"Select multiple tags\"\n                        textFieldProps={{\n                            label: 'Tags',\n                            InputLabelProps: {\n                                shrink: true\n                            },\n                            variant: 'standard'\n                        }}\n                        options={suggestions}\n                        isMulti\n                    />\n                </DialogContent>\n\n                {eventDialog.type === 'new' ? (\n                    <DialogActions className=\"justify-between pl-8 sm:pl-16\">\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            onClick={() => {\n                                addEvent(this.state);\n                                this.closeComposeDialog();\n                            }}\n                            disabled={!this.canBeSubmitted()}\n                        >\n                            Add\n                        </Button>\n                    </DialogActions>\n                ) : (\n                        <DialogActions className=\"justify-between pl-8 sm:pl-16\">\n                            <Button\n                                variant=\"contained\"\n                                color=\"primary\"\n                                onClick={() => {\n                                    updateEvent(this.state);\n                                    this.closeComposeDialog();\n                                }}\n                                disabled={!this.canBeSubmitted()}\n                            > Save\n                        </Button>\n                            <IconButton\n                                onClick={() => {\n                                    removeEvent(this.state.id);\n                                    this.closeComposeDialog();\n                                }}\n                            >\n                                <Icon>delete</Icon>\n                            </IconButton>\n                        </DialogActions>\n                    )}\n            </Dialog>\n        );\n    }\n}\n\n\nfunction mapDispatchToProps(dispatch) {\n    return bindActionCreators({\n        closeEditEventDialog: Actions.closeEditEventDialog,\n        closeNewEventDialog: Actions.closeNewEventDialog,\n        addEvent: Actions.addEvent,\n        updateEvent: Actions.updateEvent,\n        removeEvent: Actions.removeEvent\n    }, dispatch);\n}\n\nfunction mapStateToProps({ calendarApp }) {\n    return {\n        eventDialog: calendarApp.events.eventDialog\n    }\n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EventDialog);\n"]},"metadata":{},"sourceType":"module"}